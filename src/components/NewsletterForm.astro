---

---

<form id="newsletter-form" class="max-w-md mx-auto">
    <input
        type="email"
        required
        id="email"
        name="email"
        autocomplete="off"
        class="w-full px-4 py-3 border rounded-xl mb-3"
    />
    <button
        class="w-full bg-coral text-white py-3 rounded-xl hover:bg-[#d56b63] transition"
    >
        Suscribirme
    </button>
    <p
        id="success-msg"
        class="hidden text-green-600 text-sm text-center mt-2 animate-fadeIn"
    >
    </p>
    <p
        id="error-msg"
        class="hidden text-red-600 text-sm text-center mt-2 animate-fadeIn"
    >
    </p>
</form>

<script>
    import { actions } from "astro:actions";

    const form = document.querySelector("form");
    const successMsg = document.querySelector(
        "#success-msg",
    ) as HTMLParagraphElement;
    const errorMsg = document.querySelector(
        "#error-msg",
    ) as HTMLParagraphElement;
    form?.addEventListener("submit", async (event) => {
        event.preventDefault();
        successMsg.textContent = "";
        errorMsg.textContent = "";
        successMsg.classList.add("hidden");
        errorMsg.classList.add("hidden");

        const formData = new FormData(form);
        const { data, error } = await actions.newsletter(formData);
        if (error) {
            errorMsg.textContent =
                error.message || "OcurriÃ³ un error al suscribirte ðŸ˜¢";
            errorMsg.classList.remove("hidden");
        } else if (!data?.success) {
            errorMsg.textContent =
                data.message || "OcurriÃ³ un error al suscribirte ðŸ˜¢";
            errorMsg.classList.remove("hidden");
        } else if (data?.success) {
            successMsg.textContent =
                data.message || "Â¡Gracias por suscribirte! ðŸ’Œ";
            successMsg.classList.remove("hidden");
            form.reset(); // limpia el campo de email
        } else {
            errorMsg.textContent = "No se pudo completar la suscripciÃ³n.";
            errorMsg.classList.remove("hidden");
        }
    });
</script>

<style>
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(5px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    .animate-fadeIn {
        animation: fadeIn 0.3s ease-out;
    }
</style>
